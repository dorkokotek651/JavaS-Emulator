<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="fx.controller.MainController">
   <top>
      <VBox>
         <!-- Menu Bar -->
         <MenuBar>
            <Menu text="File">
               <MenuItem fx:id="loadFileMenuItem" onAction="#handleLoadFile" text="Load Program File..." />
               <SeparatorMenuItem />
               <MenuItem fx:id="exitMenuItem" onAction="#handleExit" text="Exit" />
            </Menu>
            <Menu text="Theme">
               <MenuItem fx:id="lightThemeMenuItem" onAction="#handleLightTheme" text="Light" />
               <MenuItem fx:id="darkThemeMenuItem" onAction="#handleDarkTheme" text="Dark" />
               <MenuItem fx:id="highContrastThemeMenuItem" onAction="#handleHighContrastTheme" text="High Contrast" />
            </Menu>
            <Menu text="View">
               <MenuItem fx:id="toggleAnimationsMenuItem" onAction="#handleToggleAnimations" text="Enable Animations" />
            </Menu>
            <Menu text="Help">
               <MenuItem fx:id="aboutMenuItem" onAction="#handleAbout" text="About" />
            </Menu>
         </MenuBar>
         
         <!-- Top Section: Two-row Controls Layout -->
         <VBox fx:id="topControlsSection" spacing="5" styleClass="top-controls-section">
            
            <!-- First Row: Load File + Currently Loaded File Path -->
            <HBox alignment="CENTER_LEFT" spacing="10">
               <!-- Load File Button (green) -->
               <Button fx:id="loadFileButton" onAction="#handleLoadFile" prefHeight="30.0" 
                       styleClass="load-file-button" 
                       text="Load File" />
               
               <!-- Currently Loaded File Path (dark background) -->
               <Label fx:id="currentFilePathLabel" prefWidth="300.0" prefHeight="30.0"
                      styleClass="current-file-path-label" 
                      text="No file loaded" HBox.hgrow="ALWAYS" />
            </HBox>
            
            <!-- Second Row: Program Controls + Expansion Controls + Highlight -->
            <HBox alignment="CENTER_LEFT" spacing="10">
               <!-- Program/Function Selector (green dropdown) -->
               <ComboBox fx:id="programFunctionSelector" prefWidth="150.0" prefHeight="30.0"
                         styleClass="program-function-selector" 
                         promptText="Main Program" />
               
               <!-- Level Selector Dropdown -->
               <ComboBox fx:id="levelSelector" prefWidth="100.0" prefHeight="30.0"
                         styleClass="level-selector"
                         promptText="Level" onAction="#handleLevelSelection" />
               
               <!-- Current/Maximum Degree Display -->
               <Label fx:id="levelDisplayLabel" prefHeight="30.0" styleClass="level-display-label" 
                      text="0/0" />
               
               <!-- Highlight Selection Dropdown -->
               <ComboBox fx:id="highlightSelectionCombo" prefWidth="150.0" prefHeight="30.0"
                         promptText="Highlight..." />
            </HBox>
         </VBox>
      </VBox>
   </top>
   
   <center>
      <!-- Middle Section: Split Pane (Instructions Table | Debug Panel) -->
      <SplitPane fx:id="middleSplitPane" dividerPositions="0.6" orientation="HORIZONTAL">
         
         <!-- Left Side: Instructions Table Area -->
         <VBox>
            <!-- Instructions Table -->
            <TableView fx:id="instructionsTable" VBox.vgrow="ALWAYS">
               <columns>
                  <TableColumn fx:id="commandNumberColumn" prefWidth="50.0" text="#" />
                  <TableColumn fx:id="commandTypeColumn" prefWidth="50.0" text="B\S" />
                  <TableColumn fx:id="labelColumn" prefWidth="80.0" text="Label" />
                  <TableColumn fx:id="cyclesColumn" prefWidth="70.0" text="Cycles" />
                  <TableColumn fx:id="instructionColumn" prefWidth="300.0" text="Instruction" />
               </columns>
               <columnResizePolicy>
                  <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
               </columnResizePolicy>
            </TableView>
            
            <!-- Summary Line -->
            <Label fx:id="summaryLabel" styleClass="summary-label-container" 
                   text="No program loaded" />
         </VBox>
         
         <!-- Right Side: Debugger/Execution Panel (Color-coded sections) -->
         <VBox spacing="5" style="-fx-padding: 5;">
            
            <!-- Top: Debug/Execution Controls (Yellow section) -->
            <VBox fx:id="debugControlsSection" spacing="5" styleClass="debug-controls-section">
               <Label styleClass="debug-section-title" text="Debug/Execution Controls" />
               
               <!-- New Run Workflow - All in One Row -->
               <HBox alignment="CENTER_LEFT" spacing="15">
                  <Button fx:id="newRunButton" onAction="#handleNewRun" 
                          styleClass="new-run-button"
                          text="New Run" prefWidth="120.0" prefHeight="35.0" />
                  
                  <ComboBox fx:id="executionModeCombo" prefWidth="100.0" prefHeight="30.0"
                            styleClass="execution-mode-combo"
                            promptText="Select Mode" />
                  
                  <Button fx:id="finalStartButton" onAction="#handleFinalStart" 
                          styleClass="final-start-button"
                          text="Start Run" prefWidth="120.0" prefHeight="35.0" />
               </HBox>
               
               <!-- Debug Controls -->
               <HBox spacing="10">
                  <Button fx:id="stepOverButton" onAction="#handleStepOver" text="Step Over" />
                  <Button fx:id="stopButton" onAction="#handleStop" text="Stop" />
                  <Button fx:id="resumeButton" onAction="#handleResume" text="Resume" />
               </HBox>
            </VBox>
            
            <!-- Middle: Variables and Inputs (Pink and Blue sections) -->
            <HBox spacing="5" VBox.vgrow="ALWAYS">
               
               <!-- Left Column: Variables and Cycles (Pink sections) -->
               <VBox spacing="5" HBox.hgrow="ALWAYS">
                  <!-- Variables Display (Pink section) -->
                  <VBox fx:id="variablesSection" spacing="5" styleClass="variables-section-container" VBox.vgrow="ALWAYS">
                     <Label styleClass="variables-section-title" text="Variables" />
                     <TableView fx:id="variablesTable" VBox.vgrow="ALWAYS">
                        <columns>
                           <TableColumn fx:id="variableNameColumn" prefWidth="80.0" text="Name" />
                           <TableColumn fx:id="variableValueColumn" prefWidth="80.0" text="Value" />
                        </columns>
                        <columnResizePolicy>
                           <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                     </TableView>
                  </VBox>
                  
                  <!-- Cycles Display (Pink section) -->
                  <VBox fx:id="cyclesSection" spacing="5" styleClass="cycles-section-container">
                     <Label styleClass="cycles-section-title" text="Cycles" />
                     <Label fx:id="cyclesLabel" styleClass="cycles-label" text="Total Cycles: 0" />
                  </VBox>
               </VBox>
               
               <!-- Right Column: Execution Inputs (Blue section) -->
               <VBox fx:id="executionInputsSection" spacing="5" styleClass="execution-inputs-section" HBox.hgrow="ALWAYS">
                  <Label styleClass="execution-inputs-title" text="Execution Inputs" />
                  <ScrollPane VBox.vgrow="ALWAYS">
                     <VBox fx:id="inputsContainer" spacing="5" />
                  </ScrollPane>
                  <HBox spacing="5" visible="false">
                     <Button fx:id="addInputButton" onAction="#handleAddInput" text="Add Input" />
                     <Button fx:id="removeInputButton" onAction="#handleRemoveInput" text="Remove Input" />
                  </HBox>
               </VBox>
            </HBox>
         </VBox>
      </SplitPane>
   </center>
   
   <bottom>
      <VBox>
         <!-- Status Bar -->
         <Label fx:id="statusLabel" styleClass="status-label-container" text="Ready" />
         
         <!-- Bottom Section: Split Pane (History Chain | Statistics Table) -->
         <SplitPane fx:id="bottomSplitPane" dividerPositions="0.5" orientation="HORIZONTAL" prefHeight="200.0">
            
            <!-- Left Side: Selected Instruction History Chain -->
            <VBox>
               <Label styleClass="history-section-title" text="Selected Instruction History Chain" />
               <TableView fx:id="historyChainTable" VBox.vgrow="ALWAYS">
                  <columns>
                     <TableColumn fx:id="historyCommandNumberColumn" prefWidth="50.0" text="#" />
                     <TableColumn fx:id="historyCommandTypeColumn" prefWidth="50.0" text="B\S" />
                     <TableColumn fx:id="historyLabelColumn" prefWidth="80.0" text="Label" />
                     <TableColumn fx:id="historyCyclesColumn" prefWidth="70.0" text="Cycles" />
                     <TableColumn fx:id="historyInstructionColumn" prefWidth="200.0" text="Instruction" />
                  </columns>
                  <columnResizePolicy>
                     <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                  </columnResizePolicy>
               </TableView>
            </VBox>
            
            <!-- Right Side: History/Statistics Table -->
            <VBox>
               <Label styleClass="statistics-section-title" text="History/Statistics Table" />
               <TableView fx:id="statisticsTable" VBox.vgrow="ALWAYS">
                  <columns>
                     <TableColumn fx:id="runNumberColumn" prefWidth="60.0" text="Run #" />
                     <TableColumn fx:id="expansionLevelColumn" prefWidth="80.0" text="Level" />
                     <TableColumn fx:id="inputsColumn" prefWidth="100.0" text="Inputs" />
                     <TableColumn fx:id="yValueColumn" prefWidth="60.0" text="Y Value" />
                     <TableColumn fx:id="totalCyclesColumn" prefWidth="70.0" text="Cycles" />
                     <TableColumn fx:id="actionsColumn" prefWidth="120.0" text="Actions" />
                  </columns>
                  <columnResizePolicy>
                     <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                  </columnResizePolicy>
               </TableView>
            </VBox>
         </SplitPane>
      </VBox>
   </bottom>
</BorderPane>
